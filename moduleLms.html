

<!DOCTYPE html>
<html class="writer-html5" lang="ru" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Модуль landmarks.py &mdash; документация Human State Detection preview 1.2.1</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=bc2f3c57"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/translations.js?v=9bfe3ffa"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Алфавитный указатель" href="genindex.html" />
    <link rel="search" title="Поиск" href="search.html" />
    <link rel="next" title="Модуль Depth Estimator" href="moduleDE.html" />
    <link rel="prev" title="Развертывание на собственном сервере" href="server.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Human State Detection
              <img src="_static/text1.png" class="logo" alt="Логотип"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Поиск в документации" aria-label="Поиск в документации" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Меню навигации">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html">Основная документация</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Развертывание на собственном сервере</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Модуль <code class="docutils literal notranslate"><span class="pre">landmarks.py</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">Обзор</a></li>
<li class="toctree-l2"><a class="reference internal" href="#facelandmarksprocessor">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Инициализация</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-landmarks">Метод <code class="docutils literal notranslate"><span class="pre">process_landmarks</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#facelandmarksresult">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksResult</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Атрибуты</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Методы</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#get-full-mask"><code class="docutils literal notranslate"><span class="pre">get_full_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#save-image-path"><code class="docutils literal notranslate"><span class="pre">save_image(path)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">Примеры использования</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">Пример 1: Обработка изображения и получение координат</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Пример 2: Скрытие глаз и рта, криволинейная обрезка</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Пример 3: Получение маски лица на полном изображении</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id10">Дополнительная информация</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="moduleDE.html">Модуль Depth Estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="modulePulse.html">Модуль <code class="docutils literal notranslate"><span class="pre">pulse.py</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Меню навигации для мобильных устройств" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Human State Detection</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Навигация по страницам">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Модуль <code class="docutils literal notranslate"><span class="pre">landmarks.py</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/moduleLms.rst.txt" rel="nofollow"> Просмотреть исходный код страницы</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="landmarks-py">
<h1>Модуль <code class="docutils literal notranslate"><span class="pre">landmarks.py</span></code><a class="headerlink" href="#landmarks-py" title="Ссылка на этот заголовок"></a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">Содержание</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id2" id="id11">Обзор</a></p></li>
<li><p><a class="reference internal" href="#facelandmarksprocessor" id="id12">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id13">Инициализация</a></p></li>
<li><p><a class="reference internal" href="#process-landmarks" id="id14">Метод <code class="docutils literal notranslate"><span class="pre">process_landmarks</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#facelandmarksresult" id="id15">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksResult</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id16">Атрибуты</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id17">Методы</a></p>
<ul>
<li><p><a class="reference internal" href="#get-full-mask" id="id18"><code class="docutils literal notranslate"><span class="pre">get_full_mask()</span></code></a></p></li>
<li><p><a class="reference internal" href="#save-image-path" id="id19"><code class="docutils literal notranslate"><span class="pre">save_image(path)</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id20">Примеры использования</a></p>
<ul>
<li><p><a class="reference internal" href="#id7" id="id21">Пример 1: Обработка изображения и получение координат</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id22">Пример 2: Скрытие глаз и рта, криволинейная обрезка</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id23">Пример 3: Получение маски лица на полном изображении</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id10" id="id24">Дополнительная информация</a></p></li>
</ul>
</nav>
<p>Этот модуль предназначен для обработки изображений лиц и извлечения координат лицевых ориентиров (landmarks) с использованием библиотеки <code class="docutils literal notranslate"><span class="pre">mediapipe</span></code>. Он предоставляет класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code> для обнаружения лиц на изображениях, извлечения координат ориентиров и выполнения различных операций, таких как скрытие глаз/рта и криволинейная обрезка.</p>
<section id="id2">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Обзор</a><a class="headerlink" href="#id2" title="Ссылка на этот заголовок"></a></h2>
<p>Модуль состоит из двух основных классов:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code>: Основной класс для обработки изображений и извлечения лицевых ориентиров.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FaceLandmarksResult</span></code>: Класс, содержащий результаты обработки, включая исходное изображение, обработанное изображение, координаты ориентиров и маску лица.</p></li>
</ul>
</section>
<section id="facelandmarksprocessor">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code></a><a class="headerlink" href="#facelandmarksprocessor" title="Ссылка на этот заголовок"></a></h2>
<section id="id3">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Инициализация</a><a class="headerlink" href="#id3" title="Ссылка на этот заголовок"></a></h3>
<p>Для начала работы с модулем необходимо создать экземпляр класса <code class="docutils literal notranslate"><span class="pre">FaceLandmarksProcessor</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rzd_detector.codemodules.face.emotions.landmarks</span> <span class="kn">import</span> <span class="n">FaceLandmarksProcessor</span>

<span class="n">processor</span> <span class="o">=</span> <span class="n">FaceLandmarksProcessor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code>: (bool, optional) Если <code class="docutils literal notranslate"><span class="pre">True</span></code>, будут отображаться отладочные изображения. По умолчанию <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</section>
<section id="process-landmarks">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Метод <code class="docutils literal notranslate"><span class="pre">process_landmarks</span></code></a><a class="headerlink" href="#process-landmarks" title="Ссылка на этот заголовок"></a></h3>
<p>Этот метод является основным для обработки изображений. Он принимает путь к изображению или изображение в формате <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, обнаруживает лицевые ориентиры и применяет опциональные модификации:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_landmarks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hide_eyes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">hide_mouth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">mouth_k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">curve_crop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">return_image</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;FaceLandmarksResult&quot;</span><span class="p">:</span>
</pre></div>
</div>
<p><strong>Аргументы:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">image</span></code> (Union[str, numpy.ndarray]): Путь к изображению или изображение в формате OpenCV.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_path</span></code> (str, optional): Путь для сохранения обработанного изображения. Если указан, изображение будет сохранено.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hide_eyes</span></code> (bool, optional): Скрывать ли области глаз. По умолчанию <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hide_mouth</span></code> (bool, optional): Скрывать ли область рта. По умолчанию <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mouth_k</span></code> (float, optional): Коэффициент для закрытия губ (0-1 и больше). По умолчанию <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_crop</span></code> (bool, optional): Применять ли криволинейную обрезку лица. По умолчанию <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_image</span></code> (bool, optional): Возвращать ли обработанное изображение вместе с маркерами. По умолчанию <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_raw</span></code> (bool, optional): Возвращать ли landmarks в необработанном виде. По умолчанию <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<p><strong>Возвращает:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FaceLandmarksResult</span></code>: Объект, содержащий результаты обработки. Возвращает <code class="docutils literal notranslate"><span class="pre">None</span></code>, если лицо не обнаружено.</p></li>
</ul>
<p><strong>Пример использования:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/your/image.jpg&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_landmarks</span><span class="p">(</span>
        <span class="n">image_path</span><span class="p">,</span>
        <span class="n">save_path</span><span class="o">=</span><span class="s2">&quot;path/to/save/processed_image.jpg&quot;</span><span class="p">,</span>
        <span class="n">hide_eyes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">hide_mouth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">curve_crop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">return_image</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">processed_image</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">processed_image</span>  <span class="c1"># Получаем обработанное изображение</span>
        <span class="c1"># Дальнейшая работа с изображением</span>
<span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Лицо не обнаружено&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="facelandmarksresult">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Класс <code class="docutils literal notranslate"><span class="pre">FaceLandmarksResult</span></code></a><a class="headerlink" href="#facelandmarksresult" title="Ссылка на этот заголовок"></a></h2>
<p>Этот класс предназначен для хранения результатов обработки изображения.</p>
<section id="id4">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Атрибуты</a><a class="headerlink" href="#id4" title="Ссылка на этот заголовок"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">original_image</span></code> (numpy.ndarray): Исходное изображение.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">landmarks</span></code> (numpy.ndarray): Координаты маркеров лица.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">processed_image</span></code> (numpy.ndarray): Обработанное изображение (доступно, если <code class="docutils literal notranslate"><span class="pre">return_image=True</span></code> в <code class="docutils literal notranslate"><span class="pre">process_landmarks</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">raw</span></code> (numpy.ndarray): Необработанные координаты маркеров лица (None если <code class="docutils literal notranslate"><span class="pre">return_raw=False</span></code> в <code class="docutils literal notranslate"><span class="pre">process_landmarks</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_crop_info</span></code> (dict): Информация об обрезке лица, используемая для восстановления координат на полном изображении.</p></li>
</ul>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Методы</a><a class="headerlink" href="#id5" title="Ссылка на этот заголовок"></a></h3>
<section id="get-full-mask">
<h4><a class="toc-backref" href="#id18" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">get_full_mask()</span></code></a><a class="headerlink" href="#get-full-mask" title="Ссылка на этот заголовок"></a></h4>
<p>Возвращает маску исходного изображения, где область лица выделена белым цветом. Маска вычисляется с использованием сохраненных координат обрезки.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_full_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
<p><strong>Возвращает:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>: Маска лица на исходном изображении. Возвращает <code class="docutils literal notranslate"><span class="pre">None</span></code>, если информация об обрезке отсутствует.</p></li>
</ul>
<p><strong>Пример использования:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">full_mask</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_full_mask</span><span class="p">()</span>
<span class="k">if</span> <span class="n">full_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Дальнейшая работа с маской</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="save-image-path">
<h4><a class="toc-backref" href="#id19" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">save_image(path)</span></code></a><a class="headerlink" href="#save-image-path" title="Ссылка на этот заголовок"></a></h4>
<p>Сохраняет обработанное изображение по указанному пути.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">save_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</pre></div>
</div>
<p><strong>Аргументы:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> (str): Путь для сохранения изображения.</p></li>
</ul>
<p><strong>Пример использования:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">save_image</span><span class="p">(</span><span class="s2">&quot;path/to/save/processed_image.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Примеры использования</a><a class="headerlink" href="#id6" title="Ссылка на этот заголовок"></a></h2>
<section id="id7">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Пример 1: Обработка изображения и получение координат</a><a class="headerlink" href="#id7" title="Ссылка на этот заголовок"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">rzd_detector.codemodules.face.emotions.landmarks</span> <span class="kn">import</span> <span class="n">FaceLandmarksProcessor</span>

<span class="c1"># Инициализация процессора</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">FaceLandmarksProcessor</span><span class="p">()</span>

<span class="c1"># Путь к изображению</span>
<span class="n">image_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/your/image.jpg&quot;</span>

<span class="c1"># Обработка изображения</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_landmarks</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">return_image</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Проверка, что лицо было обнаружено</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="c1"># Получение координат лицевых ориентиров</span>
        <span class="n">landmarks</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">landmarks</span>

        <span class="c1"># Вывод координат</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Landmark </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: x=</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="n">z</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Отображение обработанного изображения</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s2">&quot;Processed Image&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">processed_image</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Лицо не обнаружено.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Пример 2: Скрытие глаз и рта, криволинейная обрезка</a><a class="headerlink" href="#id8" title="Ссылка на этот заголовок"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">rzd_detector.codemodules.face.emotions.landmarks</span> <span class="kn">import</span> <span class="n">FaceLandmarksProcessor</span>

<span class="c1"># Инициализация процессора</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">FaceLandmarksProcessor</span><span class="p">()</span>

<span class="c1"># Путь к изображению</span>
<span class="n">image_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/your/image.jpg&quot;</span>

<span class="c1"># Обработка изображения с опциями</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_landmarks</span><span class="p">(</span>
        <span class="n">image_path</span><span class="p">,</span> <span class="n">hide_eyes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_mouth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">curve_crop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_image</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Проверка, что лицо было обнаружено</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="c1"># Отображение обработанного изображения</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s2">&quot;Processed Image&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">processed_image</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Лицо не обнаружено.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id9">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Пример 3: Получение маски лица на полном изображении</a><a class="headerlink" href="#id9" title="Ссылка на этот заголовок"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">rzd_detector.codemodules.face.emotions.landmarks</span> <span class="kn">import</span> <span class="n">FaceLandmarksProcessor</span>

<span class="c1"># Инициализация процессора</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">FaceLandmarksProcessor</span><span class="p">()</span>

<span class="c1"># Путь к изображению</span>
<span class="n">image_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/your/image.jpg&quot;</span>

<span class="c1"># Обработка изображения</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_landmarks</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">return_image</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Проверка, что лицо было обнаружено</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="c1"># Получение маски лица</span>
        <span class="n">full_mask</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_full_mask</span><span class="p">()</span>

        <span class="c1"># Отображение маски</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s2">&quot;Full Mask&quot;</span><span class="p">,</span> <span class="n">full_mask</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Лицо не обнаружено.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Дополнительная информация</a><a class="headerlink" href="#id10" title="Ссылка на этот заголовок"></a></h2>
<ul class="simple">
<li><p>Для работы с модулем необходимо установить библиотеку <code class="docutils literal notranslate"><span class="pre">mediapipe</span></code>.</p></li>
<li><p>Координаты лицевых ориентиров нормализованы в диапазоне [0, 1].</p></li>
<li><p>Параметр <code class="docutils literal notranslate"><span class="pre">mouth_k</span></code> позволяет регулировать степень закрытия рта при применении маски.</p></li>
</ul>
<p>Этот модуль предоставляет удобный и гибкий способ для обработки изображений лиц и извлечения лицевых ориентиров с возможностью применения различных модификаций.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Нижняя область">
        <a href="server.html" class="btn btn-neutral float-left" title="Развертывание на собственном сервере" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Предыдущая</a>
        <a href="moduleDE.html" class="btn btn-neutral float-right" title="Модуль Depth Estimator" accesskey="n" rel="next">Следующая <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Авторские права 2025, LaboRad. </p>
  </div>

  Собрано при помощи <a href="https://www.sphinx-doc.org/">Sphinx</a> с использованием
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">темы,</a>
    предоставленной <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>